(()=>{"use strict";console.log("Hello from module!");const e=document.getElementById("chat");!async function(){try{const t=await fetch("http://user08.test1.seschool.ru:3000/api/chat/");if(!t.ok)throw new Error("Wrong request");{const n=await t.json();let o="";for(const e of n)o+=`<li>${e.username}: ${e.message}</li>`;e.innerHTML=o}}catch(e){console.error(e)}}(),new EventSource("http://user08.test1.seschool.ru:3000/api/chat/subscribe").onmessage=function(t){const n=JSON.parse(t.data),o=document.createElement("li");o.innerHTML=`${n.username}: ${n.message}`,e.insertBefore(o,e.firstChild)};const t=document.getElementById("post-btn"),n=document.getElementById("name"),o=document.getElementById("email"),s=document.getElementById("message");t.addEventListener("click",(async()=>{fetch("http://user08.test1.seschool.ru:3000/api/chat/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"bearer tpSFqiCtPEJPqDxyOvQ3"},body:JSON.stringify({username:n.value,email:o.value,message:s.value})}).then((e=>e.json())).then((e=>{if(e.error)return Promise.reject(e)})).catch((e=>{console.log(e)}))}))})();